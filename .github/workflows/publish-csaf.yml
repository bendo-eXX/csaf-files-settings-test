name: Validate & publish CSAF advisories
on:
  push:
    branches:
      - main
    paths:
      - 'advisories/**.json'
      - 'advisories/**.asc'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  csaf:
    runs-on: ubuntu-24.04
    name: Create CSAF documents
    steps:
      - name: Publish CSAF advisories
        uses: csaf-tools/csaf-action@v0
        with:
          publisher_name: Example Test Company
          publisher_namespace: https://test.example.com
          publisher_issuing_authority: "We at Example Test Company are responsible for publishing and maintaining Product Test."
          publisher_contact_details: "Example Test Company can be reached at contact_us@example.com or via our website at https://test.example.com/contact."
          source_csaf_documents: advisories/
          openpgp_secret_key: ${{ secrets.CSAF_OPENPGP_SECRET_KEY }}
          openpgp_public_key: ${{ secrets.CSAF_OPENPGP_KEY }}
